<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Grammar Quest</title>

<style>
:root {
  --blue: #38bdf8;
  --bg: #020617;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle, #0f172a, var(--bg));
  color: white;
}

.game {
  max-width: 760px;
  margin: auto;
  min-height: 100vh;
  padding: 20px;
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
}

/* -------- START SCREEN -------- */

.start {
  text-align: center;
  margin: auto;
}

.start h1 {
  color: var(--blue);
  font-size: clamp(32px, 5vw, 44px);
}

.start button {
  margin-top: 30px;
  background: linear-gradient(135deg, #22d3ee, #0ea5e9);
  border: none;
  border-radius: 22px;
  padding: 22px 40px;
  font-size: 28px;
  font-weight: bold;
  color: #020617;
  cursor: pointer;
}

/* -------- GAME UI -------- */

h1 {
  text-align: center;
  color: var(--blue);
  font-size: clamp(26px, 4vw, 36px);
  margin: 5px 0 15px;
}

.top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: clamp(16px, 2.5vw, 20px);
  margin-bottom: 14px;
}

.phrase {
  background: #020617;
  border: 3px solid var(--blue);
  border-radius: 18px;
  padding: 20px;
  font-size: clamp(22px, 3.5vw, 30px);
  text-align: center;
  margin-bottom: 20px;
}

.answers {
  display: grid;
  grid-template-columns: 1fr;
  gap: 14px;
}

button.answer {
  background: linear-gradient(135deg, #22d3ee, #0ea5e9);
  border: none;
  border-radius: 18px;
  padding: 18px;
  font-size: clamp(20px, 3vw, 26px);
  font-weight: bold;
  color: #020617;
  cursor: pointer;
  min-height: 64px;
}

button.answer:active {
  transform: scale(0.97);
}

.feedback {
  text-align: center;
  font-size: clamp(20px, 3vw, 26px);
  margin-top: 18px;
  min-height: 34px;
}

.correct { color: #4ade80; }
.wrong { color: #f87171; }

.end {
  text-align: center;
  margin: auto;
  font-size: clamp(22px, 3vw, 28px);
}

.restart {
  margin-top: 25px;
  background: linear-gradient(135deg, #4ade80, #22c55e);
  border: none;
  border-radius: 20px;
  padding: 18px 30px;
  font-size: 24px;
  font-weight: bold;
  color: #052e16;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="game" id="game">

  <!-- START SCREEN -->
  <div id="startScreen" class="start">
    <h1>üéÆ GRAMMAR QUEST</h1>
    <p style="font-size:22px;">Appuie pour jouer</p>
    <button onclick="startFromTouch()">‚ñ∂Ô∏è JOUER</button>
  </div>

  <!-- GAME UI -->
  <div id="gameUI" style="display:none;">
    <h1>üéÆ GRAMMAR QUEST</h1>

    <div class="top">
      <div id="lives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
      <div id="counter">1 / 50</div>
      <div id="score">‚≠ê 0</div>
    </div>

    <div class="phrase" id="phrase"></div>
    <div class="answers" id="answers"></div>
    <div class="feedback" id="feedback"></div>
  </div>

</div>

<!-- SOUNDS -->
<audio id="goodSound" src="data:audio/wav;base64,UklGRlIAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YUwAAAB//v/+//7//v/+//7//v/+//7//v/+"></audio>
<audio id="badSound"  src="data:audio/wav;base64,UklGRlIAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YUwAAAD+/f79/v3+/f79/v3+"></audio>
<audio id="endSound"  src="data:audio/wav;base64,UklGRlIAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YUwAAAD+/v7+/v7+/v7+"></audio>

<script>
/* ---------- QUESTIONS (60 uniques) ---------- */

const baseQuestions = [
 ["Marie a ____ les pommes.", "mang√©"],
 ["Les pommes que Marie a ____.", "mang√©es"],
 ["Paul a ____ son sac.", "pr√©par√©"],
 ["Le sac que Paul a ____.", "pr√©par√©"],
 ["Les lettres que Julie a ____.", "√©crites"],
 ["Julie a ____ des lettres.", "√©crit"],
 ["Ils sont ____ √† l‚Äô√©cole.", "arriv√©s"],
 ["Elles sont ____ ensemble.", "venues"],
 ["Lucas a ____ ses devoirs.", "termin√©"],
 ["Les devoirs que Lucas a ____.", "termin√©s"],
 ["Emma a ____ sa chambre.", "rang√©"],
 ["La chambre qu‚ÄôEmma a ____.", "rang√©e"],
 ["Ils ont ____ le match.", "gagn√©"],
 ["Les matchs qu‚Äôils ont ____.", "gagn√©s"],
 ["Elle a ____ une histoire.", "racont√©"],
 ["Les histoires qu‚Äôelle a ____.", "racont√©es"],
 ["Nous sommes ____ tr√®s t√¥t.", "partis"],
 ["Elles sont ____ fatigu√©es.", "devenues"],
 ["Il a ____ une erreur.", "fait"],
 ["Les erreurs qu‚Äôil a ____.", "faites"],
 ["Les cadeaux que L√©a a ____.", "ouverts"],
 ["L√©a a ____ les cadeaux.", "ouvert"],
 ["Ils ont ____ la porte.", "ferm√©"],
 ["La porte qu‚Äôils ont ____.", "ferm√©e"],
 ["Elle a ____ la chanson.", "chant√©"],
 ["La chanson qu‚Äôelle a ____.", "chant√©e"],
 ["Ils ont ____ leurs affaires.", "pr√©par√©"],
 ["Les affaires qu‚Äôils ont ____.", "pr√©par√©es"],
 ["Il est ____ en retard.", "arriv√©"],
 ["Elles sont ____ en avance.", "arriv√©es"],
 ["Paul a ____ un dessin.", "fait"],
 ["Le dessin que Paul a ____.", "fait"],
 ["Elle a ____ une tarte.", "pr√©par√©"],
 ["La tarte qu‚Äôelle a ____.", "pr√©par√©e"],
 ["Ils ont ____ le chemin.", "trouv√©"],
 ["Le chemin qu‚Äôils ont ____.", "trouv√©"],
 ["Elle est ____ √† la maison.", "rentr√©e"],
 ["Ils sont ____ du bus.", "descendus"],
 ["Elle a ____ ses cl√©s.", "perdu"],
 ["Les cl√©s qu‚Äôelle a ____.", "perdues"],
 ["Il a ____ un cadeau.", "re√ßu"],
 ["Le cadeau qu‚Äôil a ____.", "re√ßu"],
 ["Ils ont ____ leurs erreurs.", "corrig√©"],
 ["Les erreurs qu‚Äôils ont ____.", "corrig√©es"],
 ["Elle est ____ tr√®s vite.", "partie"],
 ["Nous avons ____ le film.", "regard√©"],
 ["Le film que nous avons ____.", "regard√©"],
 ["Elle a ____ la porte.", "ouvert"],
 ["La porte qu‚Äôelle a ____.", "ouverte"],
 ["Ils sont ____ contents.", "rest√©s"],
 ["Elle a ____ son manteau.", "mis"],
 ["Le manteau qu‚Äôelle a ____.", "mis"],
 ["Ils ont ____ la le√ßon.", "appris"],
 ["La le√ßon qu‚Äôils ont ____.", "apprise"],
 ["Elle est ____ malade.", "tomb√©e"]
];

/* ---------- GAME LOGIC ---------- */

function shuffle(a){ return a.sort(()=>Math.random()-0.5); }

function variants(correct){
  const base = correct.replace(/e?s?$/, "");
  return shuffle([base, base+"e", base+"s", base+"es"]).slice(0,4);
}

function buildQuestions(){
  return shuffle(baseQuestions)
    .slice(0,50)
    .map(([phrase,correct])=>({
      phrase,
      correct,
      choices: shuffle(variants(correct))
    }));
}

let questions, index, lives, score;

const phraseEl = document.getElementById("phrase");
const answersEl = document.getElementById("answers");
const feedbackEl = document.getElementById("feedback");

function unlockAudio(){
  ["goodSound","badSound","endSound"].forEach(id=>{
    const a=document.getElementById(id);
    a.play().then(()=>{a.pause();a.currentTime=0;}).catch(()=>{});
  });
}

function startFromTouch(){
  unlockAudio();
  document.getElementById("startScreen").style.display="none";
  document.getElementById("gameUI").style.display="block";
  startGame();
}

function startGame(){
  questions = buildQuestions();
  index = 0;
  lives = 3;
  score = 0;
  load();
}

function load(){
  if(index>=50 || lives<=0){ end(); return; }
  const q = questions[index];
  phraseEl.textContent = q.phrase;
  answersEl.innerHTML="";
  feedbackEl.textContent="";
  document.getElementById("lives").textContent="‚ù§Ô∏è".repeat(lives);
  document.getElementById("score").textContent="‚≠ê "+score;
  document.getElementById("counter").textContent=(index+1)+" / 50";

  q.choices.forEach(c=>{
    const b=document.createElement("button");
    b.className="answer";
    b.textContent=c;
    b.onclick=()=>answer(c);
    answersEl.appendChild(b);
  });
}

function answer(c){
  const q=questions[index];
  if(c===q.correct){
    score+=10;
    feedbackEl.textContent="‚úÖ Bonne r√©ponse !";
    feedbackEl.className="feedback correct";
    document.getElementById("goodSound").play();
  } else {
    lives--;
    feedbackEl.textContent="‚ùå Mauvaise r√©ponse !";
    feedbackEl.className="feedback wrong";
    document.getElementById("badSound").play();
  }
  index++;
  setTimeout(load, 1100);
}

function end(){
  document.getElementById("endSound").play();
  document.getElementById("game").innerHTML=`
    <div class="end">
      <h1>üèÅ FIN DE PARTIE</h1>
      <p>Score final : <strong>${score}</strong></p>
      <p>${score>=400?"üåü Excellent joueur !":"üí™ Continue !"}</p>
      <button class="restart" onclick="location.reload()">üîÑ Recommencer</button>
    </div>
  `;
}
</script>

</body>
</html>

